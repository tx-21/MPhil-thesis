\chapter{Conclusions and Recommendations}
\section{Conclusions}
\subsection{Machine learning models versus deep learning models}
The selection of using which machine learning and deep learning models was not widely discussed to the best of our knowledge in modelling forecasting models in the wastewater treatment industry. This study has investigated the model performance of the machine learning model of RF and four other deep learning models of DNN, RNN, GRU, and LSTM on forecasting ammonia concentrations and colour levels in the reclaimed water system for assisting treatment operation and management. The evidence from this study suggested deep learning models are much capable of learning from historical data and generating more accurate forecasting results. In both ammonia and colour forecasting models, the test loss values of RF are much higher than those of the least-performance deep learning model of DNN. Among all the deep learning models, the results indicate that LSTM and GRU models have the lowest test loss of 0.0405 and 0.0414, respectively. However, further research works suggest that LSTM models trained with pre-processing methods generate the lowest test loss compared to GRU, making the LSTM model the most promising recurrent neural network model for training forecasting models in WWTPs.

\subsection{Data pre-processing techniques}
Our research also highlighted how the model performance could be improved by applying data pre-processing and feature engineering techniques. Generally speaking, all the proposed data smoothing and outlier removal methods reduced the test loss values compared to the baseline model performance (i.e., the window sizes of the data smoothing filters need to be carefully selected), as shown in Fig.~\ref{fig:preprocessing-comparison}. Ammonia and colour forecasting models trained by EWMA filtered datasets showed the lowest test loss values compared with models trained by SG filtered datasets and datasets applied with outlier removal methods. Applying an EWMA filter on training datasets can reduce the noise and allow the important patterns to stand out more clearly. The information hidden in the convoluted data points then can be further captured by the memorizing cells in the recurrent neural networks such as GRU and LSTM.

%This paper has investigated on how much the data pre-processed methods and feature engineering techniques can improve the performance on the ammonia and colour forecasting models. The evidence from this study suggests ammonia forecasting model trained by SG filter (i.e., LSTM-1-sg7) reduced test loss by 4.2\%, and model trained with engineered features (i.e., LSTM-4-sg7) reduced test loss by 8.9\%. Showing 

\subsection{Feature engineering techniques}
This study is the first step towards enhancing our understanding of the potential benefits of using created features for model training. The thorough examinations of the Geomap near the SHWEPP and the investigation of water composition in the public sewage system helped us hypothesize that the change of ammonia concentrations and colour levels depend on each other. With the help of an additional colour/ammonia feature for the ammonia/colour forecasting models, the test loss was reduced by 6.4\% (i.e., LSTM-2-sg7 compared to LSTM-1-obs) and 10.8\% (i.e., LSTM-2-ew4 compared to LSTM-1-obs), respectively.

Moreover, the similarity between the household consumption patterns and the daily fluctuation of ammonia concentrations have unexpectedly helped us formulate the time features via positional encodings. The influence of the sine and cosine hour features on the model performance showed tremendous improvements in both ammonia and colour forecasting models. In the former, test loss dropped by 8.9\% (i.e., LSTM-1-obs compared with LSTM-4-sg7) while the latter reduced by 28.6\% (i.e., LSTM-1-obs compared with LSTM-3-sg9). The remarkable use of positional encoding features is that they are not limited to ammonia and colour forecasting models. Any time-series data characterized by daily fluctuation patterns can adopt the use of the features of sine and cosine hour as long as the patterns are based on actual events. In addition, the positional encoding features are not limited to the hour component, we can encode time component features from seconds to weeks, and even years, the application of it is unlimited. However, the feature engineering method comes with limitations. In the results of ammonia forecasting models, LSTM-2-obs, LSTM-3-obs, and LSTM-4-obs showed higher test loss compared to LSTM-1-obs, indicating that when the models were not trained with ammonia feature only, the model performance worsened. Our results suggested that feature engineering needs to be carefully evaluated and experimented with before its real application. Despite the limitations, the combination use of feature engineering in building ammonia and colour forecasting models in this study has fully proved its advantages.

\section{Recommendations for future research}
Due to the insufficient amount of ammonia and colour data, we cannot ensure the proposed methods in this study can also be applied to datasets of larger size and with more complex daily patterns of water quality. Therefore, it is recommended to collect a larger dataset (i.e., data collected from a longer time period) and a dataset including a variety of fluctuation patterns to support the findings of the results in this study. There are three concerns when training forecasting models with insufficient dataset size. First, a small dataset has simple and regular patterns of daily fluctuation in both NH$_{3}$-N and colour datasets. The patterns were similar on a daily basis, and days with irregular patterns were not observed. With such an easy-to-predict pattern, we could not demonstrate the advantages of using deep learning models and data enhancement techniques to forecast water quality. Second, we cannot conclude how the size of the dataset can affect the model performance. The sensitivity analysis was commonly practiced for finding the dataset size influence on model training. It is possible to increase the model performance simply by training on a larger dataset. Third, insufficient data could also lead to unstable performance when the same data smoothing techniques were applied for training different models. For instance, models trained by sg7 filtered dataset (LSTM-4-sg7 and LSTM-3-sg7) have the lowest test loss values; however, LSTM-2-ew4 has a lower test loss than LSTM-4-sg7. We failed to explain why models trained by the sg7 filtered dataset influenced ammonia forecasting models differently among LSTM-2, LSTM-3, and LSTM-4. It is necessary to elucidate the influence of each data pre-processing technique to establish robust strategies for smoothing the training datasets.

More focus should be shifted to the fouling behavior and the accuracy of the on-line sensors in the wastewater treatment plant. Despite the fact that the development of on-line sensors is mature for providing on-line data in short time intervals (e.g., every minute), the fouling behavior due to microorganisms and the accuracy of the on-line sensors subject to the measurement technology (i.e., ion-selective exchange method for measuring NH$_{3}$-N is less accurate than wet-analyzer) are major concerns. We have noticed only mild NH$_{3}$-N sensor fouling behaviors were found and did not influence the collected data quality. In future studies, the data collected from on-line sensors should be carefully analyzed to identify how much the sensor fouling behavior can potentially affect our model performance. Meanwhile, more on-line sensors should be installed in the treatment process, such as turbidity and E. coli. Installing multiple on-line sensors will allow us to develop models which are more accurate. In addition, data collected from sensors will allow us to build a soft sensor, which can help identify the fouling behavior of the on-line sensors.

Previous research studies have demonstrated using Matlab-Simulink to simulate the improved process control strategies using machine learning model controls compared to PID or other traditional mathematical models. In future works, the study will explore writing the physical and operational characteristics of the water reclaimed system into the Matlab-Simulink. By implementing the models developed in this study on Matlab, we can investigate how the improvements in model forecasting accuracy can help the process control strategy in stabilizing the reclaimed water quality. Several metrics can be used to evaluate the machine learning model control, such as the required time to reach set-point conditions and how much reclaimed water in volume we can generate from the same amount of wastewater effluent recycled.